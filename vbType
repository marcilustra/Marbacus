Imports System.Media

Private output As Double
Private left As Double = 0
Private right As Double = 0
Private answered As Boolean = False

Private Sub clickSound(audioPath As String)
    Dim soundPlayer As New SoundPlayer(audioPath)
    soundPlayer.Play()
End Sub

Private Sub clearDisplay()
    topLabel.Text = ""
    bottomLabel.Text = "0"
End Sub

Private Sub wipeVars()
    left = 0
    right = 0
    output = 0
End Sub

Private Sub clearAll()
    clickSound("audio/tick.wav")
    clearDisplay()
    wipeVars()
End Sub

Private Sub delEat()
    Dim labelText As String = bottomLabel.Text
    If labelText.Length = 1 Then
        clearDisplay()
    Else
        bottomLabel.Text = labelText.Substring(0, labelText.Length - 1)
        clickSound("audio/pop.ogg")
    End If
End Sub

Private Sub appendNumber(val As String)
    clickSound("audio/click.wav")
    Dim labelText As String = bottomLabel.Text
    Dim topText As String = topLabel.Text
    If answered Then
        wipeVars()
        Console.WriteLine(output)
    End If

    If topText = "Ans: " Then
        topLabel.Text = ""
    End If

    If labelText = "0" Or answered Then
        bottomLabel.Text = val
        answered = False
    Else
        bottomLabel.Text &= val
    End If
End Sub

Private Sub dotIT(val As String)
    Dim labelText As String = bottomLabel.Text
    If Not labelText.Contains(".") Then
        bottomLabel.Text &= val
        clickSound("audio/click.wav")
    End If
End Sub

Private Sub performOperation(val As String)
    clickSound("audio/snap.wav")
    Dim labelText As String = bottomLabel.Text
    Dim topLabelText As String = topLabel.Text

    If topLabelText = "" Then
        output = Double.Parse(labelText)
    Else
        strictEval()
    End If

    left = output
    topLabel.Text = left & " " & val
    bottomLabel.Text = "0"
End Sub

Private Sub strictEval()
    Dim finalOperand As Char = topLabel.Text.Last()
    Select Case finalOperand
        Case "+"
            output += Double.Parse(bottomLabel.Text)
        Case "-"
            output -= Double.Parse(bottomLabel.Text)
        Case "X"
            output *= Double.Parse(bottomLabel.Text)
        Case "/"
            Dim divisor As Double = Double.Parse(bottomLabel.Text)
            If divisor = 0 Then
                bottomLabel.Text = "Don't do that!"
                Threading.Thread.Sleep(5000)
                Application.Restart()
                Return
            Else
                output /= divisor
            End If
        Case "^"
            output ^= Double.Parse(bottomLabel.Text)
    End Select
End Sub

Private Sub updateDisplay()
    bottomLabel.Text = output.ToString()
    topLabel.Text = "Ans: "
    answered = True
    Console.WriteLine("Answer: " & output)
End Sub

Private Sub displayFinal()
    If topLabel.Text <> "" Then
        clickSound("audio/succ.wav")
        strictEval()
        updateDisplay()
    End If
End Sub
